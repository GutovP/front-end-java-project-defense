<div class="container pt-4 custom-width">
    <form [formGroup]="profileForm" class="bg-info p-4">
        <fieldset>
            <h3 class="text-center mt-3">User Info:</h3>

            <!-- firstName -->
            <div class="mt-5">
                <label for="firstName">First name</label>
                <div class="d-flex align-items-center">
                    <ng-container *ngIf="showEditMode['firstName']" class="flex-grow-1">
                        <input formControlName="firstName" type="text" class="form-control me-2" id="firstName"
                            placeholder="Enter first name">

                    </ng-container>
                    <ng-container *ngIf="!showEditMode['firstName']" class="flex-grow-1">
                        <div class="form-control text-bg-light me-2">{{user.firstName}}</div>
                    </ng-container>
                    <div class="d-flex flex-column">
                        <button class="btn btn-primary me-2" type="button" (click)="toggleEditMode('firstName')"
                            *ngIf="!showEditMode['firstName']">Edit</button>
                        <button class="btn btn-primary" type="button" (click)="updateField('firstName')"
                            *ngIf="showEditMode['firstName']">Save</button>
                    </div>
                </div>
                <p *ngIf="firstname?.touched && firstname?.hasError('required')" class="error w-100">
                    First name is required! </p>
                <p *ngIf="firstname?.hasError('minlength') || firstname?.hasError('maxlength')" class="error w-100">
                    First name length must be between 3 and 20 characters!</p>
            </div>

            <!-- lastName -->
            <div class="mt-3">
                <label for="lastName">Last name</label>
                <div class="d-flex align-items-center">
                    <ng-container *ngIf="showEditMode['lastName']" class="flex-grow-1">
                        <input formControlName="lastName" type="text" class="form-control me-2" id="lastName"
                            placeholder="Enter last name">
                    </ng-container>
                    <ng-container *ngIf="!showEditMode['lastName']" class="flex-grow-1">
                        <div class="form-control text-bg-light me-2">{{user.lastName}}</div>
                    </ng-container>
                    <div class="d-flex flex-column">
                        <button class="btn btn-primary me-2" type="button" (click)="toggleEditMode('lastName')"
                            *ngIf="!showEditMode['lastName']">Edit</button>
                        <button class="btn btn-primary" type="button" (click)="updateField('lastName')"
                            *ngIf="showEditMode['lastName']">Save</button>
                    </div>
                </div>
                <p *ngIf="lastname?.touched && lastname?.hasError('required')" class="error w-100">
                    Last name is required! </p>
                <p *ngIf="lastname?.hasError('minlength') || lastname?.hasError('maxlength')" class="error w-100">
                    Last name length must be between 3 and 20 characters!</p>
            </div>

            <!-- Email -->
            <div class="mt-3">
                <label for="email">Email</label>
                <div class="d-flex align-items-center">
                    <ng-container *ngIf="showEditMode['email']" class="flex-grow-1">
                        <input formControlName="email" type="email" class="form-control me-2" id="email"
                            placeholder="Enter Email" autocomplete="new-password">
                    </ng-container>
                    <ng-container *ngIf="!showEditMode['email']" class="flex-grow-1">
                        <div class="form-control text-bg-light me-2">{{user.email}}</div>
                    </ng-container>
                    <div class="d-flex flex-column">
                        <button class="btn btn-primary me-2" type="button" (click)="toggleEditMode('email')"
                            *ngIf="!showEditMode['email']">Edit</button>
                        <button class="btn btn-primary" type="button" (click)="updateField('email')"
                            *ngIf="showEditMode['email']">Save</button>
                    </div>
                </div>
                <p *ngIf="email?.touched && email?.hasError('required')" class="error w-100">
                    Email is required! </p>
                <p *ngIf="email?.hasError('emailValidator')" class="error w-100">
                    Email is not valid</p>
            </div>

            <!-- Password -->
            <div class="mt-3">
                <label for="password">Password</label>
                <div class="d-flex align-items-center">
                    <!-- Display Hidden Password when Not Editing -->
                    <ng-container *ngIf="!showEditMode['password']" class="flex-grow-1">
                        <div class="form-control text-bg-light me-2">**********</div>
                    </ng-container>

                    <!-- Display Password Fields when in Edit Mode -->
                    <ng-container *ngIf="showEditMode['password']" class="flex-grow-1">
                        <div class="w-100">
                            <input formControlName="currentPassword" type="password" class="form-control me-2"
                                placeholder="Current Password">
                            <p *ngIf="profileForm.get('currentPassword')?.touched && profileForm.get('currentPassword')?.hasError('required')"
                                class="error w-100">
                                Current password is required!
                            </p>

                            <input formControlName="newPassword" type="password" class="form-control me-2"
                                placeholder="New Password">
                            <p *ngIf="profileForm.get('newPassword')?.touched && profileForm.get('newPassword')?.hasError('required')"
                                class="error w-100">
                                New password is required!
                            </p>
                            <p *ngIf="profileForm.get('newPassword')?.errors?.['minlength'] || profileForm.get('newPassword')?.errors?.['maxlength']"
                                class="error">
                                Password length must be between 6 and 20 characters!
                            </p>

                            <input formControlName="confirmNewPassword" type="password" class="form-control me-2"
                                placeholder="Repeat New Password">
                            <p *ngIf="confirmNewPassword?.hasError('passwordGroupValidator')" class="error">
                                Passwords do not match!
                            </p>
                        </div>
                    </ng-container>

                    <!-- Edit / Save Buttons -->
                    <div class="d-flex flex-column">
                        <button class="btn btn-primary me-1" type="button" (click)="toggleEditMode('password')"
                            *ngIf="!showEditMode['password']">Edit</button>
                        <button class="btn btn-primary me-1" type="button" (click)="updateField('password')"
                            *ngIf="showEditMode['password']">Save</button>
                    </div>
                </div>
            </div>
        </fieldset>
    </form>
</div>